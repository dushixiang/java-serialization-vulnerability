package cn.typesafe.jsv.serializable2.shiro;

import org.apache.shiro.mgt.SecurityManager;
import org.apache.shiro.web.mgt.CookieRememberMeManager;
import org.apache.shiro.web.mgt.DefaultWebSecurityManager;
import org.springframework.context.annotation.Configuration;

import javax.annotation.PostConstruct;
import javax.annotation.Resource;
import java.util.Base64;

@Configuration
public class ShiroSecurityConfig {

    @Resource
    private SecurityManager securityManager;

    @PostConstruct
    public void init() {
        // 配置记住登录管理器，并且设置 AES 加密的 key
        CookieRememberMeManager cookieRememberMeManager = new CookieRememberMeManager();
        cookieRememberMeManager.setCipherKey(Base64.getDecoder().decode("zSyK5Kp6PZAAjlT+eeNMlg=="));
        ((DefaultWebSecurityManager) securityManager).setRememberMeManager(cookieRememberMeManager);
    }
}
